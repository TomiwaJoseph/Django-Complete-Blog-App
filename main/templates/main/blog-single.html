{% extends 'main/base.html' %}
{% load static %}
{% load main_tags %}


{% block content %}
<div class="row">
  <div class="container">
    
    {% for i in blog %}
    <img src="{{ header_img.0 }}" alt="" class="img-fluid mb-2">
    <div class="post-meta single-meta">
      <span class="author mr-2 text-secondary"><img class="mr-1" src="/media/images/person_1.jpg" alt=""
          class="img-fluid">
        {{ i.author }}</span>
      <span class="mr-2 text-secondary">{{ i.created | date:'F d, Y' }} </span> &bullet;
      <span class="ml-2 text-secondary"><span class="fa fa-comments"></span> {{ comments.count }}</span>
    </div>
    <h1 class="mb-4">{{ i.title }}</h1>
    <a class="category mb-5" href="{% url 'category_finder' category %}">{{ category }}</a>
    {% endfor %}

    
    <div class="blog-content-body">

      {% for i in begin_ %}
        <p>{{ content|lookup:i|safe }}</p>
      {% endfor %}
      
      <div class="row">
        {% for i in images_indexes %}
        <div class="col-md-6">
          <img src="{{ content|lookup:i }}" alt="" class="img-fluid mb-2">
        </div>
        {% endfor %}
      </div>
      
      {% for i in end_ %}
        <div class="mt-2">
          <p>{{ content|lookup:i|safe }}</p>
        </div>
      {% endfor %}
      
    </div>
    
    <div class="pt-5">
      <p>Tags: <a class="category" href="{% url 'tag_finder' tags.0 %}">#{{tags.0}}</a> 
        <a class="category" href="{% url 'tag_finder' tags.1 %}">#{{tags.1}}</a> 
        <a class="category" href="{% url 'tag_finder' tags.2 %}">#{{tags.2}}</a></p>
    </div>

    <div class="pt-5">
      {% with comments.count as total_comments %}
        <h3 class="mb-5">{{ total_comments }} Comment{{ total_comments|pluralize }}</h3>
      {% endwith %}
      <ul class="comment-list">
        {% for comment in comments %}
        <li class="comment">
          <div class="vcard">
            <img src="/media/images/person_2.jpg" alt="Image placeholder">
          </div>
          <div class="comment-body">
            <h3>{{ comment.name }}</h3>
            <div class="meta">{{ comment.created | date:'F d, Y' }} at {{ comment.created | date:'P'}}</div>
            <p>{{ comment.body }}</p>
            <!-- <p><a href="#" class="reply rounded">Reply</a></p> -->
          </div>
        </li>
        {% endfor %}
      </ul>


      <!-- END comment-list -->
      <div class="comment-form-wrap pt-2">
        {% if user.is_authenticated %}
        <h3 class="mb-5">Leave a comment</h3>
        <form action="{% url 'comment' %}" method="POST" class="p-5 bg-light">
          {% csrf_token %}
          <input type="hidden" name="id" value="{{ current_id }}">
          <div class="form-group">
            <label for="name">Name *</label>
            <input type="text" class="form-control" name="name" required>
          </div>
          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" class="form-control" name="email" required>
          </div>
          <div class="form-group">
            <label for="message">Message *</label>
            <textarea name="message" cols="30" rows="10" class="form-control" required></textarea>
          </div>
          <div class="form-group">
            <input type="submit" value="Post Comment" class="btn btn-primary com">
          </div>
        </form>
        {% else %}
          <div class="col-md-12">
            <h5 class="my-2">Please login to add a comment.</h5>
          </div>
        {% endif %}
      </div>
    </div>

  </div>

</div>




{% endblock %}